\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{danielbahnheader}[2014/08/21 Example package]

\RequirePackage[margin=1in,headheight=5\baselineskip,headsep=1\baselineskip,includehead]{geometry}
\RequirePackage{tabularx}
\RequirePackage{graphicx}
\RequirePackage{multirow}
\RequirePackage{lastpage}
\RequirePackage{fancyhdr}

%% set up and width for the tabularx environment to expand and fit to.
\newcommand{\makeHeader}{
    \newlength{\headerwidth}
    \setlength{\headerwidth}{\textwidth}
    \newsavebox{\myheader}
    \begin{lrbox}{\myheader}%
        \begin{minipage}[b]{\headerwidth}
        \renewcommand{\arraystretch}{1.29}%
        \begin{tabularx}{\headerwidth}{|@{}c@{}|X|c|}\hline
        \multirow{3}{*}{\includegraphics[height=0.65in]{example-image-a}}
                        & \multicolumn{1}{c|}{ DANIEL BAHN }
                        & PR \\ %\cline{3-3}
                        & \centering\textbf{\Large Normativa General }  & \textbf{\Large 22-000} \\ %\cline{3-3}
                        &  \centering\textbf{\large Normas Generales a Cumplir} &  DRAFT  \\ \hline
        \end{tabularx}
        \par
        \bfseries
        Procedimiento Recomendado\hspace*{\fill} 
        Enero 2022
        \end{minipage}
    \end{lrbox}
    \newsavebox{\myfooter}
    \begin{lrbox}{\myfooter}%
        \begin{minipage}[b]{\headerwidth}
        \renewcommand{\arraystretch}{1.29}%
        \begin{tabularx}{\headerwidth}{|@{}c@{}|X|c|}\hline
        \multirow{2}{*}{\small \copyright DANIEL BAHN}
        & \centering{ RP-22-000 }  & Pagina \\ 
        & \centering\textbf{\large Normativa General}   & \thepage\ / \pageref{LastPage} \\ \hline
        \end{tabularx}

        \end{minipage}
    \end{lrbox}

    %% Setting up the header

    \pagestyle{fancy}
    \renewcommand{\headrulewidth}{0pt}
    \renewcommand{\footrulewidth}{0pt}
    \lhead{}
    \chead{\usebox{\myheader}}
    \rhead{}
    \lfoot{}
    \cfoot{\usebox{\myfooter}}
    \rfoot{}
}